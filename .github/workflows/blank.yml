name: Windows-2025 Cloud Computer (Supremo)

on:
  workflow_dispatch:
    inputs:
      pin:
        description: 'PIN for your Supremo cloud PC (4-6 digits)'
        required: true
      name:
        description: 'Friendly name for your cloud PC'
        required: true

jobs:
  setup-supremo:
    runs-on: windows-2025
    steps:
      - name: Download Supremo
        shell: pwsh
        run: |
          $url = "https://www.nanosystems.it/public/download/Supremo.exe"
          $output = "$env:TEMP\Supremo.exe"
          Write-Output "Downloading Supremo..."
          Invoke-WebRequest -Uri $url -OutFile $output
          Write-Output "Downloaded Supremo to $output"

      - name: Start Supremo
        shell: pwsh
        env:
          SUPREMO_PIN: ${{ github.event.inputs.pin }}
          CLOUDPC_NAME: ${{ github.event.inputs.name }}
        run: |
          $pin = $env:SUPREMO_PIN
          $cloudPCName = $env:CLOUDPC_NAME
          $supremoPath = "$env:TEMP\Supremo.exe"

          Write-Output "Starting Supremo..."
          Start-Process -FilePath $supremoPath -ArgumentList "/PIN $pin /NAME $cloudPCName /RUN" -WindowStyle Hidden

          Start-Sleep -Seconds 5
          Write-Output "üíª Your Supremo cloud PC '$cloudPCName' is running!"
          Write-Output "üîë PIN: $pin"
          Write-Output "You can connect using Supremo with the displayed PIN."

      - name: Spam Message & Keep Alive for 5 Hours
        shell: pwsh
        env:
          CLOUDPC_NAME: ${{ github.event.inputs.name }}
          SUPREMO_PIN: ${{ github.event.inputs.pin }}
        run: |
          $durationHours = 5
          $durationSeconds = $durationHours * 3600
          $startTime = Get-Date
          $cloudPCName = $env:CLOUDPC_NAME
          $pin = $env:SUPREMO_PIN
          $ram = "8‚Äì16 GB"
          $storage = "256 GB (C:) + smaller D: drive"
          $cpu = "AMD EPYC (2‚Äì4 vCores)"

          while ((Get-Date) - $startTime -lt (New-TimeSpan -Seconds $durationSeconds)) {
              Write-Output "üéâ Enjoy using your computer! üíª '$cloudPCName'"
              Write-Output "üñ•Ô∏è Specs: RAM: $ram | Storage: $storage | CPU: $cpu"
              Write-Output "üîë Supremo PIN: $pin"
              Write-Output "This computer runs for 6 hours. ‚è∞"
              Write-Output "To get a new cloud computer, simply relaunch this workflow. üöÄ"
              Start-Sleep -Seconds 5
          }

          Write-Output "‚è∞ 5 hours reached. Job completed. ‚úÖ"
