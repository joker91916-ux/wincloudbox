name: Windows-2025 Cloud Computer (Supremo)

on:
  workflow_dispatch:
    inputs:
      pin:
        description: 'PIN for your Supremo cloud PC (4-6 digits)'
        required: true
      name:
        description: 'Friendly name for your cloud PC'
        required: true

jobs:
  setup-supremo:
    runs-on: windows-2025
    steps:
      - name: Download Supremo
        shell: pwsh
        run: |
          $url = "https://www.nanosystems.it/public/download/Supremo.exe"
          $output = "$env:TEMP\Supremo.exe"
          Write-Output "Downloading Supremo..."
          Invoke-WebRequest -Uri $url -OutFile $output
          Write-Output "Downloaded Supremo to $output"

      - name: Start Supremo
        shell: pwsh
        run: |
          $supremoPath = "$env:TEMP\Supremo.exe"
          $pin = "${{ github.event.inputs.pin }}"
          $cloudPCName = "${{ github.event.inputs.name }}"

          Write-Output "Starting Supremo..."
          Start-Process -FilePath $supremoPath -ArgumentList "/PIN $pin /NAME $cloudPCName /RUN" -WindowStyle Hidden

          # Wait a few seconds for Supremo to initialize
          Start-Sleep -Seconds 5

          # Try to get the Supremo ID from running process registry (if available)
          # Supremo ID is usually generated dynamically; for simplicity, we just print that it's running
          Write-Output "ðŸ’» Your Supremo cloud PC '$cloudPCName' is running!"
          Write-Output "ðŸ”‘ PIN: $pin"
          Write-Output "You can connect using Supremo with the displayed PIN."

      - name: Spam Message & Keep Alive for 5 Hours
        shell: pwsh
        run: |
          $durationHours = 5
          $durationSeconds = $durationHours * 3600
          $startTime = Get-Date
          $cloudPCName = "${{ github
